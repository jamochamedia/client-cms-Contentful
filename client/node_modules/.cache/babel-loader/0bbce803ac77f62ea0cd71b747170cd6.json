{"ast":null,"code":"import Auth0 from \"auth0-js\";\nimport config from \"./config\";\nimport localConfig from \"./localConfig\"; // import hostedConfig from \"./hostedConfig\";\n\nvar requestedScopes = \"openid profile admin client:linkedin content:editor content:writer sales:admin\";\nvar auth0Client = new Auth0.WebAuth({\n  domain: config.auth0.domain,\n  clientID: config.auth0.client,\n  redirectUri: config.auth0.redirectUri,\n  audience: config.auth0.audience,\n  responseType: \"token id_token\",\n  scope: this.requestedScopes\n}); //Handles Login\n\nexport function ssoLogin(email, history) {\n  auth0Client.passwordlessStart({\n    connection: \"email\",\n    send: \"link\",\n    email: email\n  }, function (err, res) {\n    console.log(err);\n    if (err) throw new Error(\"User could not be sent sign on link error: \".concat(err));\n    var email = res.email,\n        emailVerified = res.emailVerified,\n        Id = res.Id;\n    console.log(\"id ->\", Id);\n\n    if (email && Id) {\n      if (!emailVerified) {\n        history.push(\"/verify\");\n        return true;\n      }\n\n      history.push(\"/home\");\n      return true;\n    }\n\n    throw new Error(\"No user was returned\");\n  });\n} //Sets access and id tokens = handleAuthentication();\n\nexport function setAuthItems(callback) {\n  auth0Client.parseHash({}, function (err, result) {\n    if (err) {\n      console.log(err);\n      callback(err, null);\n      return;\n    }\n\n    setSession(result);\n    callback(null, result);\n  });\n  console.log(\"grabbed auth tokens\");\n}\nexport function getAccessToken() {\n  var accessToken = localStorage.getItem(\"accessToken\");\n\n  if (accessToken) {\n    return accessToken;\n  }\n\n  console.log(\"set access token\");\n}\nexport function getIdToken() {\n  var idToken = localStorage.getItem(\"idToken\");\n\n  if (idToken) {\n    return idToken;\n  }\n\n  console.log(\"got id token\");\n}\nexport function setSession(result) {\n  //Set isLoggedIn flag in localStorage\n  localStorage.setItem(\"isLoggedIn\", \"true\");\n  var accessToken = result.accessToken,\n      idToken = result.idToken;\n  localStorage.setItem(\"idToken\", idToken);\n  localStorage.setItem(\"accessToken\", accessToken);\n  scopes = console.log(\"set session\");\n} //TODO: RENEWSESSION FIX\n\nexport function renewSession() {\n  auth0Client.checkSession({}, function (err, result) {\n    if (err) {\n      console.log(err);\n      console.log(\"Could not get new user token\");\n      logout();\n    }\n\n    setSession(result);\n  });\n}\nexport function areAuthItemsSet() {\n  var idToken = localStorage.getItem(\"idToken\");\n  var accessToken = localStorage.getItem(\"accessToken\");\n\n  if (idToken && accessToken) {\n    return true;\n  }\n\n  return false;\n}\nexport function logout() {\n  auth0Client.logout({\n    returnTo: localConfig.urls.login,\n    // returnTo: hostedConfig.urls.login,\n    client_id: config.auth0.client\n  }); //Clear access and id token\n\n  localStorage.removeItem(\"idToken\");\n  localStorage.removeItem(\"accessToken\"); //Remove isLoggedIn flag from localStorage\n\n  localStorage.removeItem(\"isLoggedIn\");\n  console.log(\"you are logged out\");\n}","map":{"version":3,"sources":["/Users/mehakvohra/Documents/Dev/Jamocha Media/client-cms-contentful/src/utils/Auth/Auth.js"],"names":["Auth0","config","localConfig","requestedScopes","auth0Client","WebAuth","domain","auth0","clientID","client","redirectUri","audience","responseType","scope","ssoLogin","email","history","passwordlessStart","connection","send","err","res","console","log","Error","emailVerified","Id","push","setAuthItems","callback","parseHash","result","setSession","getAccessToken","accessToken","localStorage","getItem","getIdToken","idToken","setItem","scopes","renewSession","checkSession","logout","areAuthItemsSet","returnTo","urls","login","client_id","removeItem"],"mappings":"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","sourcesContent":["import Auth0 from \"auth0-js\";\nimport config from \"./config\";\nimport localConfig from \"./localConfig\";\n// import hostedConfig from \"./hostedConfig\";\n\nconst requestedScopes =\n  \"openid profile admin client:linkedin content:editor content:writer sales:admin\";\n\nconst auth0Client = new Auth0.WebAuth({\n  domain: config.auth0.domain,\n  clientID: config.auth0.client,\n  redirectUri: config.auth0.redirectUri,\n  audience: config.auth0.audience,\n  responseType: \"token id_token\",\n  scope: this.requestedScopes\n});\n\n//Handles Login\nexport function ssoLogin(email, history) {\n  auth0Client.passwordlessStart(\n    {\n      connection: \"email\",\n      send: \"link\",\n      email\n    },\n    (err, res) => {\n      console.log(err);\n      if (err)\n        throw new Error(`User could not be sent sign on link error: ${err}`);\n\n      const { email, emailVerified, Id } = res;\n      console.log(\"id ->\", Id);\n      if (email && Id) {\n        if (!emailVerified) {\n          history.push(\"/verify\");\n          return true;\n        }\n        history.push(\"/home\");\n        return true;\n      }\n      throw new Error(\"No user was returned\");\n    }\n  );\n}\n\n//Sets access and id tokens = handleAuthentication();\nexport function setAuthItems(callback) {\n  auth0Client.parseHash({}, (err, result) => {\n    if (err) {\n      console.log(err);\n      callback(err, null);\n      return;\n    }\n    setSession(result);\n    callback(null, result);\n  });\n  console.log(\"grabbed auth tokens\");\n}\n\nexport function getAccessToken() {\n  const accessToken = localStorage.getItem(\"accessToken\");\n  if (accessToken) {\n    return accessToken;\n  }\n  console.log(\"set access token\");\n}\n\nexport function getIdToken() {\n  const idToken = localStorage.getItem(\"idToken\");\n  if (idToken) {\n    return idToken;\n  }\n  console.log(\"got id token\");\n}\n\nexport function setSession(result) {\n  //Set isLoggedIn flag in localStorage\n  localStorage.setItem(\"isLoggedIn\", \"true\");\n\n  const { accessToken, idToken } = result;\n  localStorage.setItem(\"idToken\", idToken);\n  localStorage.setItem(\"accessToken\", accessToken);\n\n  scopes = console.log(\"set session\");\n}\n\n//TODO: RENEWSESSION FIX\nexport function renewSession() {\n  auth0Client.checkSession({}, (err, result) => {\n    if (err) {\n      console.log(err);\n      console.log(\"Could not get new user token\");\n      logout();\n    }\n    setSession(result);\n  });\n}\n\nexport function areAuthItemsSet() {\n  const idToken = localStorage.getItem(\"idToken\");\n  const accessToken = localStorage.getItem(\"accessToken\");\n\n  if (idToken && accessToken) {\n    return true;\n  }\n  return false;\n}\n\nexport function logout() {\n  auth0Client.logout({\n    returnTo: localConfig.urls.login,\n    // returnTo: hostedConfig.urls.login,\n    client_id: config.auth0.client\n  });\n\n  //Clear access and id token\n  localStorage.removeItem(\"idToken\");\n  localStorage.removeItem(\"accessToken\");\n\n  //Remove isLoggedIn flag from localStorage\n  localStorage.removeItem(\"isLoggedIn\");\n\n  console.log(\"you are logged out\");\n}\n"]},"metadata":{},"sourceType":"module"}